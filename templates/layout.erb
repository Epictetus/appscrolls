# >---------------------------------------------------------------------------<
# 
#                ______   __           ____             ____  
#               / __/ /__/ /__ _____  / __/__________  / / /__
#              / _// / _  / _ `/ __/ _\ \/ __/ __/ _ \/ / (_-<
#             /___/_/\_,_/\_,_/_/   /___/\__/_/  \___/_/_/___/
#
#   This template was generated by Eldar Scrolls, the amazing and awesome Rails
#     application template builder. Get started at http://eldarscrolls.org
#
# >---------------------------------------------------------------------------<

# >----------------------------[ Initial Setup ]------------------------------<

initializer 'generators.rb', <<-RUBY
Rails.application.config.generators do |g|
end
RUBY

@scrolls = <%= resolve_scrolls.map(&:key).inspect %> 

<%= render "helpers" %>

<% resolve_scrolls.each do |scroll| %>
<%= render 'scroll', scroll.get_binding %>
<% end %>

<% if custom_code? %># >-----------------------------[ Custom Code ]-------------------------------<

<%= custom_code %><% end %>

@current_scroll = nil

# >-----------------------------[ Run Bundler ]-------------------------------<

say_wizard "Running Bundler install. This will take a while."
run 'bundle install'
say_wizard "Running after Bundler callbacks."
@after_blocks.each{|b| config = @configs[b[0]] || {}; @current_scroll = b[0]; b[1].call}

@current_scroll = nil
say_wizard "Running after everything callbacks."
@after_everything_blocks.each{|b| config = @configs[b[0]] || {}; @current_scroll = b[0]; b[1].call}
